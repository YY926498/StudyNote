# 非进程组的组长创建新会话

如果调用`pid_t setsid(void)`函数的进程不是进程组的组长，则会创建一个新会话，具体会发生如下事情：

- 该进程变成新会话的会话首进程。此时，该进程是新会话中的唯一进程
- 该进程成为一个新进程组的组长进程。新进程组ID是该调用进程的进程ID
- 该进程没有控制终端。如果调用函数之前有控制终端，那么这种联系也会被切断

如果调用进程是进程组的组长，则此函数返回出错。为了保证不出现这种情况，通常是先调用fork，然后使其父进程终止，而子进程继续。因为子进程继承了父进程的进程ID，而其进程ID是新分配的，两者不可能相等，这就保证了子进程不是一个进程组的组长。