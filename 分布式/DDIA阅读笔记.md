# DDIA阅读笔记

## 第一章：可靠性，可扩展性，可维护性

现今很多应用程序是数据密集型，而非计算密集型。因此CPU很少成为这类应用的瓶颈，更大的问题通常来自数据量、数据复杂性以及数据的变更速度。

许多程序都需要：

- 存储数据，以便自己或其他应用程序之后能再次找到(数据库)
- 记住开销昂贵操作的结果，加快读取速度(缓存)
- 允许用户按关键字搜索数据，或以各种方式对数据进行过滤(搜索索引)
- 向其他进程发送消息，进行异步处理(流处理)
- 定期处理累积的大批量数据(批处理)

**可靠性(Reliability)**

系统在困境(adversity)（硬件故障、软件故障、人为错误）中仍可正常工作（正确完成功能，并能达到期望的性能水准）。

**可扩展性(Scalability)**

有合理的办法应对系统的增长（数据量、流量、复杂性）

**可维护性(Maintainability)**

许多不同的人（工程师、运维）在不同的生命周期，都能高效地在系统上工作（使系统保持现有行为，并适应新的应用场景）。



**故障(fault)**：造成错误的原因。通常定位为系统的一部分状态偏离其标准。

能预料并应对故障的系统特性可称为**容错(fault-tolerant)**或**韧性(resilient)**。

**失效(failure)**：系统作为一个整体停止向用户提供服务。

**可扩展性**：是用来描述系统应对负载增长能力的术语。

描述性能的参数：

- 吞吐量(throughput)：每秒可以处理的记录数量，或者在特定规模数据集上运行作业的总时间。
- 服务的响应时间(response time)：客户端发送请求到接收响应之间的时间。

**可维护性**：主要关注软件系统的三个设计原则：

- 可操作性：便于运维团队保持系统平稳运行。
- 简单性：从系统中消除尽可能多的复杂度，使新工程师也能轻松理解系统。
- 可演化性：使工程师在未来能够轻松地对系统进行更改，当需求变化时为新应用场景做适配。也称为可扩展性(extensibility)、可修改性(modifiability)或可塑性(plasticity)。

## 第二章：数据模型与查询语言

一个复杂的应用程序可能会有更多的中间层次，不过基本思想是：每个层都通过提供一个明确的数据模型来隐藏更低层次中的复杂性。这些抽象允许不同的人群有效地协作。

### 关系模型与文档模型

**SQL**

**NOSQL**

未来，关系数据库似乎可能继续与各种菲关系数据库一起使用，这被称为混合持久化。

#### 对象关系不匹配

如果数据存储在关系表中，那么需要一个笨拙的转换层，处于应用程序代码中的对象和表，行，列的数据库模型之间。模型之间的不连贯有时被称为阻抗不匹配。

#### 多对一和多对多的关系

#### 网络模型

网络模型中记录之间的链接不是外键，而更像编程语言中的指针（同时仍然存储在磁盘上）。访问记录的唯一方法是跟随从根记录起沿这些链路所形成的路径。这被称为访问路径。

#### 关系模型

一个关系（表）只是一个元组（行）的集合。

#### 关系型数据库与文档数据库在今日的对比

支持文档数据模型的主要论据是架构灵活性，因局部性而拥有更好的性能，以及对于某些应用程序而言更接近于应用程序使用的数据结构。关系模型通过为连接提供更好的支持以及支持多对一和多对多的关系。

#### 文档模型中架构灵活性

文档数据库存在**读时模式(schema-on-read)**（数据的结构是隐含的，只有在数据被读取时才被解释），相应的是**写时模式(schema-on-write)**（传统的关系数据库方法中，模式明确，且数据库确保所有的数据都符合其模型）。

#### 查询的数据局部性

局部性仅适用于同时需要文档绝大部分内容的情况下。

数据模型相互补充。关系模型和文档模型的混合是未来数据库的一条很好的路线。

### 数据查询语言

当引入关系模型时，关系模型包含了一种查询数据的新方法：SQL是一种声明式查询语言。

在声明式查询语言中，只需指定所需数据的模式-结果必须符合哪些条件，以及如何将数据转换，但不是如何实现这一目标。数据库系统的查询优化器决定使用哪种索引和哪些连接方法，以及以何种顺序执行查询的各个部分。

### MapReduce查询

查询的逻辑用代码片段来表示，这些代码片段会被处理框架重复性调用。基于`map`和`reduce`函数，两个函数存在于许多函数式编程语言中。

`map`和`reduce`函数在功能上有所限制：它们必须是纯函数，这意味着它们只使用传递给它们的数据作为输入，它们不能执行额外的数据查询，也不能有任何副作用。这些限制允许数据库以任何顺序运行任何功能，并在失败时重新运行它们。然而，`map`和`reduce`函数仍然是强大的：可以解析字符串，调用库函数，执行计算等。

### 图数据模型

一个图由两种对象组成：顶点和边。比如社交图谱：顶点是人，边指示哪些人彼此认识。

## 第三章：存储与检索

### 哈希索引

### SSTables和LSM树

排序字符串表(Sorted String Table, SSTable)：键值对的序列按键排序。

### B树

### 多列索引

### 全文搜索和模糊索引

### 在内存中存储一切

### 数据仓库

### 列存储

 